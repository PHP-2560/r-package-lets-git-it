---
title: "Starting Functions (finance)"
output: html_document
---

```{r setup, include=FALSE}
grow <- function(base, interest, n=1) { #grow takes the base value and grows or shrinks it by the interest rate (which should be .07 if the rate is 7%), n is how many times it should compound
  if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
  }
  for(i in 1:n){#grows it by the rate for each iteration (n many iterations)
    base = base*(1+interest)
  }
  return(base)
}

grow(10,7,10)
```

```{r}
payments <- function(base, interest, payment){ #annual payment made is payment, base is the debt, interest is the rate at which the debt grows
    if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
    }
  annual.debt <- vector(length=100)
  for(i in 1:100){
    base = (base-payment)*(1+interest)
    annual.debt[i] <- base
    n<-i
   if(base<0) break
  }
  total.pay =n*payment
  print(annual.debt)
  print(n)
  print(total.pay)
}
  
payments(100, .07, 6.5)
```

```{r}
income.driven <- function(base, interest,income) {
      if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
      }
  payment <- income/10
  annual.debt <- vector(length=20)
  for(i in 1:20){
    base = (base-payment)*(1+interest)
    annual.debt[i] <- base
   if(base<0) break
  }
  forgiven.amount <- annual.debt[20]
  print(forgiven.amount) #how much is forgiven
  print(2*income) #total amount paid (before taxes on the forgiven amount)
}

income.driven(100, .07, 5)
```

```{r}
income.driven.short <- function(base, interest,income) { #this is the special 10 year repayment where you have to work for a 401(c) *note that this has been politically contentious and that there is no gaurantee it will be upheld, even after 9 years of repayments
      if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
      }
  payment <- income/10
  annual.debt <- vector(length=10)
  for(i in 1:10){
    base = (base-payment)*(1+interest)
    annual.debt[i] <- base
   if(base<0) break
  }
  forgiven.amount <- annual.debt[10]
  print(forgiven.amount) #how much is forgiven
  print(income) #total amount paid (before taxes on the forgiven amount)
}

income.driven.short(100, .07, 5)
```