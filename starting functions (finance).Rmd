---
title: "Starting Functions (finance)"
output: html_document
---

```{r setup, include=FALSE}
grow <- function(base, interest, n=1) { #grow takes the base value and grows or shrinks it by the interest rate (which should be .07 if the rate is 7%), n is how many times it should compound
  if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
  }
  
  for(i in 1:n){#grows it by the rate for each iteration (n many iterations)
    base = base*(1+interest)
  }
  return(base)
}

grow(10,7,10)
```

```{r}
payments <- function(base, interest, payment){ #annual payment made is payment, base is the debt, interest is the rate at which the debt grows
  if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
  }
  
  annual.debt <- numeric() #initialize the annual.debt vector
  for(i in 1:100){
    base <- (base-payment)*(1+interest) 
    annual.debt <- c(annual.debt, base)
    n<-i
    if(base<payment) break #break when remaining amount left to be paid is less than our payment amount
  }
 if(annual.debt[n]< payment) annual.debt <- c(annual.debt, 0)
  total.pay = n*payment + annual.debt[n] #in addition to making the consistent annual payments, we need to add on the final payment which is less than the value we pay annually
  print(n+1) #print the number of payments we made
  print(total.pay) #print the total payments we made
  print(annual.debt) #print out the debt remaining each year

}

  
payments(100, .07, 4)#testing our function



#need to throw an error or warning to the user if it does not reach zero (if the loop doesn't break) 
```

```{r}
income.driven <- function(base, interest,income) {
      if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
      }
  
  payment <- income/10 #****ULTIMATELY WE SHOULD CHANGE INCOME TO BE A VECTOR, IT WILL VARY BY YEAR (ESP MOVING FROM RESIDENCY INTO ATTENDINGHOOD) - in the for loop we will then need to call the index year of income***
  annual.debt <- vector(length=20)
  for(i in 1:20){
    base = (base-payment)*(1+interest)
    annual.debt[i] <- base
   if(base<0) break
  }
  forgiven.amount <- annual.debt[20]
  print(forgiven.amount) #how much is forgiven
  print(2*income) #total amount paid (before taxes on the forgiven amount)
}

income.driven(100, .07, 5)
```

```{r}
income.driven.short <- function(base, interest,income) { #this is the special 10 year repayment where you have to work for a 401(c) *note that this has been politically contentious and that there is no gaurantee it will be upheld, even after 9 years of repayments
      if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
      }
  
  payment <- income/10 #****ULTIMATELY WE SHOULD CHANGE INCOME TO BE A VECTOR, IT WILL VARY BY YEAR (ESP MOVING FROM RESIDENCY INTO ATTENDINGHOOD) - in the for loop we will then need to call the index year of income***
  annual.debt <- vector(length=10)
  for(i in 1:10){
    base = (base-payment)*(1+interest)
    annual.debt[i] <- base
   if(base<0) break
  }
  forgiven.amount <- annual.debt[10]
  print(forgiven.amount) #how much is forgiven
  print(income) #total amount paid (before taxes on the forgiven amount)
}

income.driven.short(100, .07, 7)
```


```{r}

find.debt <- function(costper, interest, initial.debt =0) { #initial.debt is how much debt you enter medical school with - assumes four years of med school, assumes a constant rate of cost per year and the same interest rate on all of the loans ---- this finds how much debt people will have at 
   if(interest < -1 | interest > 1) { #in case someone misenters interest as whole number instead of decimal form
    interest = interest/100
   }
  
  total.debt = initial.debt #they start with an initial amount of debt
  for(i in 1:4) {
    total.debt = total.debt*(1+interest)
    total.debt = total.debt + costper
  }
  print(total.debt)
}


forgiveness.prep.fund <- function(amount.forgiven, growth.rate, tax.rate, years =20, print.saved=1) {#determines how much you need to put away per year to cover your tax bill on the forgiven amount from income.driven or income.driven short (for income driven short you would need to change years to 10)
  tax.debt <- amount.forgiven*tax.rate #this will show how much of your "forgiven" debt is now owed to the IRS
  test = tax.debt/(1.5*years)

  for(k in 1:20) {test = test*0.95
  saved =0
  for(i in 1:years) {
    saved = saved + test
    saved = saved*(1+growth.rate)
  }
  if(saved - tax.debt < 0){ break}
  } #*****NEED TO CHANGE IT TO ACCOUNT FOR CAPITAL GAINS TAX****
  print(test) #prints how much you need to save per year
  if(print.saved) { 
    print(saved)
    }
} #*******SHOULD ADD A CONDITION ONTO THIS TO HAVE IT WAIT UNTIL AFTER RESIDENCY TO HAVE YOU START SAVING TOWARD THIS FUND (I.E. DO 20-RES FOR YEARS)*****

forgiveness.prep.fund(1000000, .07, .3) 


post.tax.lifetime.earnings <- function(salary, tax.rate, total.payment, years=20) { #shows earnings left after a certain number of years, taking out taxes and debt, uses a flat tax rate (more accurate would be to used a stepped one), and ignores any possible deductions (i.e. pretax spending) 
  post.tax = salary*(1-tax.rate)*years
  post.tax = post.tax-total.payment #need to create a version of this for individuals who have the 10% option and for those who do military or underserved
  return(post.tax)
}

post.tax.lifetime.earnings(300000, .4, 1300000)






#STILL NEED TO MAKE AN EARNINGS VECTOR WITH RESIDENCY SALARIES DURING RES YEARS AND FULL PHYSICIAN SALARIES DURING PHYSICIAN YEARS (FOR EACH SPECIALTY) --- SIMILAR HAS TO BE DONE FOR MILITARY (WITH MED SCHOOL SALARY ADDED ON AS WELL) ---- LOTS OF DEFAULT VALUES SHOULD ALSO BE FILLED IN --- FUNCTIONS SHOULD BE MADE TO COHERE TOGETHER A BIT NICER --- COMENTS IN MOST OF THE FUNCTIONS ON HOW THEY NEED TO BE IMPROVED -- LOTS OF SMALLER TAX DETAILS MISSING (EX. STATE TAX, 2500 ON STUDENT LOAN INTEREST PER YEAR BEING PRE TAX, ETC) -- NEED TO DISTINGUISH PRIVATE AND FEDERAL LOANS -- ADD DEFERED OR IMMEDIATE REPAYMENT OPTIONS FOR RESIDENCY FOR THE PAY IN FULL OPTION -- CHANGE RATES BECAUSE I FORGOT THAT FEDERAL LOANS DONT COMPOUND IN MEDICAL SCHOOL BUT ARE SIMPLE INTEREST -- ADD IN MALPRACTICE INSURANCE?

#DISPLAY GROSS INCOME PER YEAR AND POST TAX POST STUDENTLOAN INCOME PER YEAR FOR EACH OPTION (X AXIS IS YEARS, Y IS INCOME, SEPARATE GRAPHS FOR GROSS AND 'NET')
```