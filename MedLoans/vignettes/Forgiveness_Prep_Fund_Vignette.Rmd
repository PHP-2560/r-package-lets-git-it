---
title: "Forgiveness_Prep_Fund_Vignette"
author: "Jon Spiegel and Kevin Chen"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Forgiveness_Prep_Fund_Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The `forgiveness.prep.fund()` function takes in the amount of money ultimately forgiven, the rate at which our savings grow, the tax rate, the number of years spent in residency, and the total number of years (including residency) between graduating medical school and paying off the tax bill on the forgiven loan amount and returns how much needs to be put away per year by the person taking out the loan in order to cover their ultimate tax bill. 
    
For example, suppose somebody borrowed 400,000 USD from the federal government and is becoming an oncologist (residency = 5 years, average salary = 353,000 USD). We will assume they borrowed this amount with an interest rate of 7.5% and that they will pay it back over 20 years.
    
First, we will need to find how out much of their loan will be forgiven. We can find this using the `income.driven()` function:

```{r, fig.show='hold'}
library(MedLoans)
income <- c(65000,65000,65000,65000,65000, 353000, 353000,353000, 353000,353000, 353000,353000, 353000,353000, 353000,353000, 353000,353000, 353000,353000)
income.driven(400000,.075,income, plan=20)
```

This gives us a final forgiven amount of 545732.1 USD.
    
We can then apply the `forgiveness.prep.fund()` function:
    
```{r, fig.show='hold'}
forgiveness.prep.fund(545732.1, .05, .35, 5, years=20, print.saved=0)
```

This tells us that we need to pay 8064.708 USD per year for each year after residency in order to cover the tax bill on the forgiven 545,732 USD.
    
If we set `print.saved` = 1, we can see that we owe 182,726 USD to the IRS in the end:

```{r, fig.show='hold'}
forgiveness.prep.fund(545732.1, .05, .35, 5, years=20, print.saved=1)
```


